"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55998],{63444:function(t,e,n){n.d(e,{Cf:function(){return xt},DK:function(){return Ot},K9:function(){return Tt},ML:function(){return kt},NB:function(){return Et},Nl:function(){return p},Ov:function(){return Ct},P1:function(){return g},Rw:function(){return bt},d1:function(){return nt},hj:function(){return D},nU:function(){return b},vc:function(){return St},x2:function(){return Mt},zK:function(){return wt}});var o=n(95152),s=n(35746),r=n(16331),i=n(73214),a=n(1284),c=n(67083),d=n(14927);function l(t){const{state:e,transaction:n}=t;let{selection:o}=n,{doc:s}=n,{storedMarks:r}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return r},get selection(){return o},get doc(){return s},get tr(){return o=n.selection,s=n.doc,r=n.storedMarks,n}}}class u{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:o}=e,{tr:s}=n,r=this.buildProps(s);return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,(...t)=>{const n=e(...t)(r);return s.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(s),n}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:o,state:s}=this,{view:r}=o,i=[],a=!!t,c=t||s.tr,d={...Object.fromEntries(Object.entries(n).map((([t,n])=>[t,(...t)=>{const o=this.buildProps(c,e),s=n(...t)(o);return i.push(s),d}]))),run:()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(c),i.every((t=>!0===t)))};return d}createCan(t){const{rawCommands:e,state:n}=this,o=t||n.tr,s=this.buildProps(o,false),r=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:void 0})])));return{...r,chain:()=>this.createChain(o,false)}}buildProps(t,e=!0){const{rawCommands:n,editor:o,state:s}=this,{view:r}=o;s.storedMarks&&t.setStoredMarks(s.storedMarks);const i={tr:t,editor:o,view:r,state:l({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map((([t,e])=>[t,(...t)=>e(...t)(i)])))}};return i}}function p(t,e,n){if(void 0===t.config[e]&&t.parent)return p(t.parent,e,n);if("function"===typeof t.config[e]){return t.config[e].bind({...n,parent:t.parent?p(t.parent,e,n):null})}return t.config[e]}function m(t){return{baseExtensions:t.filter((t=>"extension"===t.type)),nodeExtensions:t.filter((t=>"node"===t.type)),markExtensions:t.filter((t=>"mark"===t.type))}}function h(t){const e=[],{nodeExtensions:n,markExtensions:o}=m(t),s=[...n,...o],r={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach((t=>{const n=p(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage});if(!n)return;n().forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,o])=>{e.push({type:n,name:t,attribute:{...r,...o}})}))}))}))})),s.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},o=p(t,"addAttributes",n);if(!o)return;const s=o();Object.entries(s).forEach((([n,o])=>{const s={...r,...o};"function"===typeof(null===s||void 0===s?void 0:s.default)&&(s.default=s.default()),(null===s||void 0===s?void 0:s.isRequired)&&void 0===(null===s||void 0===s?void 0:s.default)&&delete s.default,e.push({type:t.name,name:n,attribute:s})}))})),e}function f(t,e){if("string"===typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function g(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{n[t]?n[t]="class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:n[t]=e})),n}),{})}function y(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>g(t,e)),{})}function v(t){return"function"===typeof t}function b(t,e,...n){return v(t)?e?t.bind(e)(...n):t(...n):t}function k(t,e){return t.style?t:{...t,getAttrs:n=>{const o=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===o)return!1;const s=e.reduce(((t,e)=>{const o=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!==typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return null===o||void 0===o?t:{...t,[e.name]:o}}),{});return{...o,...s}}}}function x(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!function(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(e))&&(null!==e&&void 0!==e))))}function M(t,e){var n;const o=h(t),{nodeExtensions:s,markExtensions:r}=m(t),a=null===(n=s.find((t=>p(t,"topNode"))))||void 0===n?void 0:n.name,c=Object.fromEntries(s.map((n=>{const s=o.filter((t=>t.type===n.name)),r={name:n.name,options:n.options,storage:n.storage,editor:e},i=x({...t.reduce(((t,e)=>{const o=p(e,"extendNodeSchema",r);return{...t,...o?o(n):{}}}),{}),content:b(p(n,"content",r)),marks:b(p(n,"marks",r)),group:b(p(n,"group",r)),inline:b(p(n,"inline",r)),atom:b(p(n,"atom",r)),selectable:b(p(n,"selectable",r)),draggable:b(p(n,"draggable",r)),code:b(p(n,"code",r)),defining:b(p(n,"defining",r)),isolating:b(p(n,"isolating",r)),attrs:Object.fromEntries(s.map((t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=b(p(n,"parseHTML",r));a&&(i.parseDOM=a.map((t=>k(t,s))));const c=p(n,"renderHTML",r);c&&(i.toDOM=t=>c({node:t,HTMLAttributes:y(t,s)}));const d=p(n,"renderText",r);return d&&(i.toText=d),[n.name,i]}))),d=Object.fromEntries(r.map((n=>{const s=o.filter((t=>t.type===n.name)),r={name:n.name,options:n.options,storage:n.storage,editor:e},i=x({...t.reduce(((t,e)=>{const o=p(e,"extendMarkSchema",r);return{...t,...o?o(n):{}}}),{}),inclusive:b(p(n,"inclusive",r)),excludes:b(p(n,"excludes",r)),group:b(p(n,"group",r)),spanning:b(p(n,"spanning",r)),code:b(p(n,"code",r)),attrs:Object.fromEntries(s.map((t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=b(p(n,"parseHTML",r));a&&(i.parseDOM=a.map((t=>k(t,s))));const c=p(n,"renderHTML",r);return c&&(i.toDOM=t=>c({mark:t,HTMLAttributes:y(t,s)})),[n.name,i]})));return new i.V_({topNode:a,nodes:c,marks:d})}function w(t,e){return e.nodes[t]||e.marks[t]||null}function S(t,e){return Array.isArray(e)?e.some((e=>("string"===typeof e?e:e.name)===t.name)):e}function E(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class O{constructor(t){this.find=t.find,this.handler=t.handler}}function T(t){var e;const{editor:n,from:o,to:s,text:r,rules:i,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(o);if(d.parent.type.spec.code||(null===(e=d.nodeBefore||d.nodeAfter)||void 0===e?void 0:e.marks.find((t=>t.type.spec.code))))return!1;let p=!1;const m=((t,e=500)=>{let n="";const o=t.parentOffset;return t.parent.nodesBetween(Math.max(0,o-e),o,((t,e,s,r)=>{var i,a;const c=(null===(a=(i=t.type.spec).toText)||void 0===a?void 0:a.call(i,{node:t,pos:e,parent:s,index:r}))||t.textContent||"%leaf%";n+=c.slice(0,Math.max(0,o-e))})),n})(d)+r;return i.forEach((t=>{if(p)return;const e=((t,e)=>{if(E(e))return e.exec(t);const n=e(t);if(!n)return null;const o=[n.text];return o.index=n.index,o.input=t,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o})(m,t.find);if(!e)return;const i=c.state.tr,d=l({state:c.state,transaction:i}),h={from:o-(e[0].length-r.length),to:s},{commands:f,chain:g,can:y}=new u({editor:n,state:d});null!==t.handler({state:d,range:h,match:e,commands:f,chain:g,can:y})&&i.steps.length&&(i.setMeta(a,{transform:i,from:o,to:s,text:r}),c.dispatch(i),p=!0)})),p}function C(t){const{editor:e,rules:n}=t,s=new o.Sy({state:{init:()=>null,apply(t,e){const n=t.getMeta(s);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:(t,o,r,i)=>T({editor:e,from:o,to:r,text:i,rules:n,plugin:s}),handleDOMEvents:{compositionend:t=>(setTimeout((()=>{const{$cursor:o}=t.state.selection;o&&T({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:s})})),!1)},handleKeyDown(t,o){if("Enter"!==o.key)return!1;const{$cursor:r}=t.state.selection;return!!r&&T({editor:e,from:r.pos,to:r.pos,text:"\n",rules:n,plugin:s})}},isInputRules:!0});return s}class A{constructor(t){this.find=t.find,this.handler=t.handler}}function $(t){const{editor:e,state:n,from:o,to:s,rule:r}=t,{commands:i,chain:a,can:c}=new u({editor:e,state:n}),d=[];n.doc.nodesBetween(o,s,((t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const l=Math.max(o,e),u=Math.min(s,e+t.content.size);((t,e)=>{if(E(e))return[...t.matchAll(e)];const n=e(t);return n?n.map((e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n})):[]})(t.textBetween(l-e,u-e,void 0,"\ufffc"),r.find).forEach((t=>{if(void 0===t.index)return;const e=l+t.index+1,o=e+t[0].length,s={from:n.tr.mapping.map(e),to:n.tr.mapping.map(o)},u=r.handler({state:n,range:s,match:t,commands:i,chain:a,can:c});d.push(u)}))}));return d.every((t=>null!==t))}function N(t){const{editor:e,rules:n}=t;let s=null,r=!1,i=!1;return n.map((t=>new o.Sy({view(t){const e=e=>{var n;s=(null===(n=t.dom.parentElement)||void 0===n?void 0:n.contains(e.target))?t.dom.parentElement:null};return window.addEventListener("dragstart",e),{destroy(){window.removeEventListener("dragstart",e)}}},props:{handleDOMEvents:{drop:t=>(i=s===t.dom.parentElement,!1),paste:(t,e)=>{var n;const o=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return r=!!(null===o||void 0===o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(n,o,s)=>{const a=n[0],c="paste"===a.getMeta("uiEvent")&&!r,d="drop"===a.getMeta("uiEvent")&&!i;if(!c&&!d)return;const u=o.doc.content.findDiffStart(s.doc.content),p=o.doc.content.findDiffEnd(s.doc.content);if("number"!==typeof u||!p||u===p.b)return;const m=s.tr,h=l({state:s,transaction:m});return $({editor:e,state:h,from:Math.max(u-1,0),to:p.b-1,rule:t})&&m.steps.length?m:void 0}})))}class P{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=P.resolve(t),this.schema=M(this.extensions,e),this.extensions.forEach((t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:w(t.name,this.schema)};if("mark"===t.type){(null===(e=b(p(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name)}const o=p(t,"onBeforeCreate",n);o&&this.editor.on("beforeCreate",o);const s=p(t,"onCreate",n);s&&this.editor.on("create",s);const r=p(t,"onUpdate",n);r&&this.editor.on("update",r);const i=p(t,"onSelectionUpdate",n);i&&this.editor.on("selectionUpdate",i);const a=p(t,"onTransaction",n);a&&this.editor.on("transaction",a);const c=p(t,"onFocus",n);c&&this.editor.on("focus",c);const d=p(t,"onBlur",n);d&&this.editor.on("blur",d);const l=p(t,"onDestroy",n);l&&this.editor.on("destroy",l)}))}static resolve(t){const e=P.sort(P.flatten(t)),n=function(t){const e=t.filter(((e,n)=>t.indexOf(e)!==n));return[...new Set(e)]}(e.map((t=>t.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((t=>`'${t}'`)).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map((t=>{const e=p(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...this.flatten(e())]:t})).flat(10)}static sort(t){return t.sort(((t,e)=>{const n=p(t,"priority")||100,o=p(e,"priority")||100;return n>o?-1:n<o?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n=p(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:w(e.name,this.schema)});return n?{...t,...n()}:t}),{})}get plugins(){const{editor:t}=this,e=P.sort([...this.extensions].reverse()),n=[],o=[],s=e.map((e=>{const s={name:e.name,options:e.options,storage:e.storage,editor:t,type:w(e.name,this.schema)},i=[],a=p(e,"addKeyboardShortcuts",s);let c={};if("mark"===e.type&&e.config.exitable&&(c.ArrowRight=()=>St.handleExit({editor:t,mark:e})),a){const e=Object.fromEntries(Object.entries(a()).map((([e,n])=>[e,()=>n({editor:t})])));c={...c,...e}}const d=(0,r.h)(c);i.push(d);const l=p(e,"addInputRules",s);S(e,t.options.enableInputRules)&&l&&n.push(...l());const u=p(e,"addPasteRules",s);S(e,t.options.enablePasteRules)&&u&&o.push(...u());const m=p(e,"addProseMirrorPlugins",s);if(m){const t=m();i.push(...t)}return i})).flat();return[C({editor:t,rules:n}),...N({editor:t,rules:o}),...s]}get attributes(){return h(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=m(this.extensions);return Object.fromEntries(e.filter((t=>!!p(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),o={name:e.name,options:e.options,storage:e.storage,editor:t,type:f(e.name,this.schema)},s=p(e,"addNodeView",o);if(!s)return[];return[e.name,(o,r,i,a)=>{const c=y(o,n);return s()({editor:t,node:o,getPos:i,decorations:a,HTMLAttributes:c,extension:e})}]})))}}function B(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function j(t,e){const n={...t};return B(t)&&B(e)&&Object.keys(e).forEach((o=>{B(e[o])?o in t?n[o]=j(t[o],e[o]):Object.assign(n,{[o]:e[o]}):Object.assign(n,{[o]:e[o]})})),n}class D{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=b(p(this,"addOptions",{name:this.name}))),this.storage=b(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new D(t)}configure(t={}){const e=this.extend();return e.options=j(this.options,t),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new D(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=b(p(e,"addOptions",{name:e.name})),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}}function I(t,e,n){const{from:o,to:s}=e,{blockSeparator:r="\n\n",textSerializers:i={}}=n||{};let a="",c=!0;return t.nodesBetween(o,s,((t,n,d,l)=>{var u;const p=null===i||void 0===i?void 0:i[t.type.name];p?(t.isBlock&&!c&&(a+=r,c=!0),d&&(a+=p({node:t,pos:n,parent:d,index:l,range:e}))):t.isText?(a+=null===(u=null===t||void 0===t?void 0:t.text)||void 0===u?void 0:u.slice(Math.max(o,n)-n,s-n),c=!1):t.isBlock&&!c&&(a+=r,c=!0)})),a}function R(t){return Object.fromEntries(Object.entries(t.nodes).filter((([,t])=>t.spec.toText)).map((([t,e])=>[t,e.spec.toText])))}const z=D.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:o,selection:s}=e,{ranges:r}=s,i=Math.min(...r.map((t=>t.$from.pos))),a=Math.max(...r.map((t=>t.$to.pos)));return I(o,{from:i,to:a},{textSerializers:R(n)})}}})]}});function L(t,e,n={strict:!0}){const o=Object.keys(e);return!o.length||o.every((o=>n.strict?e[o]===t[o]:E(e[o])?e[o].test(t[o]):e[o]===t[o]))}function H(t,e,n={}){return t.find((t=>t.type===e&&L(t.attrs,n)))}function F(t,e,n={}){return!!H(t,e,n)}function V(t,e,n={}){if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if(t.parentOffset===o.offset&&0!==o.offset&&(o=t.parent.childBefore(t.parentOffset)),!o.node)return;const s=H([...o.node.marks],e,n);if(!s)return;let r=o.index,i=t.start()+o.offset,a=r+1,c=i+o.node.nodeSize;for(H([...o.node.marks],e,n);r>0&&s.isInSet(t.parent.child(r-1).marks);)r-=1,i-=t.parent.child(r).nodeSize;for(;a<t.parent.childCount&&F([...t.parent.child(a).marks],e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:i,to:c}}function K(t,e){if("string"===typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function W(t){return t instanceof o.Bs}function U(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function _(t,e=null){if(!e)return null;const n=o.Y1.atStart(t),s=o.Y1.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return s;const r=n.from,i=s.to;return"all"===e?o.Bs.create(t,U(0,r,i),U(t.content.size,r,i)):o.Bs.create(t,U(e,r,i),U(e,r,i))}function q(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function G(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function Y(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"===typeof t&&null!==t)try{return Array.isArray(t)&&t.length>0?i.HY.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Y("",e,n)}if("string"===typeof t){const o=i.aw.fromSchema(e);return n.slice?o.parseSlice(G(t),n.parseOptions).content:o.parse(G(t),n.parseOptions)}return Y("",e,n)}function J(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function X(t,e,n={}){const{from:o,to:s,empty:r}=t.selection,i=e?f(e,t.schema):null,a=[];t.doc.nodesBetween(o,s,((t,e)=>{if(t.isText)return;const n=Math.max(o,e),r=Math.min(s,e+t.nodeSize);a.push({node:t,from:n,to:r})}));const c=s-o,d=a.filter((t=>!i||i.name===t.node.type.name)).filter((t=>L(t.node.attrs,n,{strict:!1})));if(r)return!!d.length;return d.reduce(((t,e)=>t+e.to-e.from),0)>=c}function Q(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Z(t,e){const n="string"===typeof e?[e]:e;return Object.keys(t).reduce(((e,o)=>(n.includes(o)||(e[o]=t[o]),e)),{})}function tt(t,e,n={}){return Y(t,e,{slice:!1,parseOptions:n})}function et(t){return e=>function(t,e){for(let n=t.depth;n>0;n-=1){const o=t.node(n);if(e(o))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:o}}}(e.$from,t)}function nt(t,e){const n=i.PW.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function ot(t,e){return I(t,{from:0,to:t.content.size},e)}function st(t,e){const n=K(e,t.schema),{from:o,to:s,empty:r}=t.selection,i=[];r?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(o,s,(t=>{i.push(...t.marks)}));const a=i.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}function rt(t,e){const n=Q("string"===typeof e?e:e.name,t.schema);return"node"===n?function(t,e){const n=f(e,t.schema),{from:o,to:s}=t.selection,r=[];t.doc.nodesBetween(o,s,(t=>{r.push(t)}));const i=r.reverse().find((t=>t.type.name===n.name));return i?{...i.attrs}:{}}(t,e):"mark"===n?st(t,e):{}}function it(t,e,n){const o=[];return t===e?n.resolve(t).marks().forEach((e=>{const s=V(n.resolve(t-1),e.type);s&&o.push({mark:e,...s})})):n.nodesBetween(t,e,((t,e)=>{o.push(...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n}))))})),o}function at(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const o=t.find((t=>t.type===e&&t.name===n));return!!o&&o.attribute.keepOnSplit})))}function ct(t,e,n={}){const{empty:o,ranges:s}=t.selection,r=e?K(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!r||r.name===t.type.name)).find((t=>L(t.attrs,n,{strict:!1})));let i=0;const a=[];if(s.forEach((({$from:e,$to:n})=>{const o=e.pos,s=n.pos;t.doc.nodesBetween(o,s,((t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),r=Math.min(s,e+t.nodeSize);i+=r-n,a.push(...t.marks.map((t=>({mark:t,from:n,to:r}))))}))})),0===i)return!1;const c=a.filter((t=>!r||r.name===t.mark.type.name)).filter((t=>L(t.mark.attrs,n,{strict:!1}))).reduce(((t,e)=>t+e.to-e.from),0),d=a.filter((t=>!r||t.mark.type!==r&&t.mark.type.excludes(r))).reduce(((t,e)=>t+e.to-e.from),0);return(c>0?c+d:c)>=i}function dt(t,e){const{nodeExtensions:n}=m(e),o=n.find((e=>e.name===t));if(!o)return!1;const s=b(p(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"===typeof s&&s.split(" ").includes("list")}function lt(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const o=n.filter((t=>null===e||void 0===e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(o)}}const ut=(t,e)=>{const n=et((t=>t.type===e))(t.selection);if(!n)return!0;const o=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===o)return!0;const s=t.doc.nodeAt(o);return n.node.type!==(null===s||void 0===s?void 0:s.type)||!(0,a.Mn)(t.doc,n.pos)||(t.join(n.pos),!0)},pt=(t,e)=>{const n=et((t=>t.type===e))(t.selection);if(!n)return!0;const o=t.doc.resolve(n.start).after(n.depth);if(void 0===o)return!0;const s=t.doc.nodeAt(o);return n.node.type!==(null===s||void 0===s?void 0:s.type)||!(0,a.Mn)(t.doc,o)||(t.join(o),!0)};var mt=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame((()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0),clearContent:(t=!1)=>({commands:e})=>e.setContent("",t),clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:o}=e,{ranges:s}=o;return!n||(s.forEach((({$from:n,$to:o})=>{t.doc.nodesBetween(n.pos,o.pos,((t,n)=>{if(t.type.isText)return;const{doc:o,mapping:s}=e,r=o.resolve(s.map(n)),i=o.resolve(s.map(n+t.nodeSize)),c=r.blockRange(i);if(!c)return;const d=(0,a.k9)(c);if(t.type.isTextblock){const{defaultType:t}=r.parent.contentMatchAt(r.index());e.setNodeMarkup(c.start,t)}(d||0===d)&&e.lift(c,d)}))})),!0)},command:t=>e=>t(e),createParagraphNear:()=>({state:t,dispatch:e})=>(0,c.mD)(t,e),deleteCurrentNode:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,o=n.$anchor.node();if(o.content.size>0)return!1;const s=t.selection.$anchor;for(let r=s.depth;r>0;r-=1){if(s.node(r).type===o.type){if(e){const e=s.before(r),n=s.after(r);t.delete(e,n).scrollIntoView()}return!0}}return!1},deleteNode:t=>({tr:e,state:n,dispatch:o})=>{const s=f(t,n.schema),r=e.selection.$anchor;for(let t=r.depth;t>0;t-=1){if(r.node(t).type===s){if(o){const n=r.before(t),o=r.after(t);e.delete(n,o).scrollIntoView()}return!0}}return!1},deleteRange:t=>({tr:e,dispatch:n})=>{const{from:o,to:s}=t;return n&&e.delete(o,s),!0},deleteSelection:()=>({state:t,dispatch:e})=>(0,c.NE)(t,e),enter:()=>({commands:t})=>t.keyboardShortcut("Enter"),exitCode:()=>({state:t,dispatch:e})=>(0,c.uo)(t,e),extendMarkRange:(t,e={})=>({tr:n,state:s,dispatch:r})=>{const i=K(t,s.schema),{doc:a,selection:c}=n,{$from:d,from:l,to:u}=c;if(r){const t=V(d,i,e);if(t&&t.from<=l&&t.to>=u){const e=o.Bs.create(a,t.from,t.to);n.setSelection(e)}}return!0},first:t=>e=>{const n="function"===typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1},focus:(t=null,e={})=>({editor:n,view:o,tr:s,dispatch:r})=>{e={scrollIntoView:!0,...e};const i=()=>{q()&&o.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(o.focus(),(null===e||void 0===e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())}))};if(o.hasFocus()&&null===t||!1===t)return!0;if(r&&null===t&&!W(n.state.selection))return i(),!0;const a=_(s.doc,t)||n.state.selection,c=n.state.selection.eq(a);return r&&(c||s.setSelection(a),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},forEach:(t,e)=>n=>t.every(((t,o)=>e(t,{...n,index:o}))),insertContent:(t,e)=>({tr:n,commands:o})=>o.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),insertContentAt:(t,e,n)=>({tr:s,dispatch:r,editor:i})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const r=Y(e,i.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===r.toString())return!0;let{from:c,to:d}="number"===typeof t?{from:t,to:t}:t,l=!0,u=!0;if((r.toString().startsWith("<")?r:[r]).forEach((t=>{t.check(),l=!!l&&(t.isText&&0===t.marks.length),u=!!u&&t.isBlock})),c===d&&u){const{parent:t}=s.doc.resolve(c);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(c-=1,d+=1)}l?Array.isArray(e)?s.insertText(e.map((t=>t.text||"")).join(""),c,d):"object"===typeof e&&e&&e.text?s.insertText(e.text,c,d):s.insertText(e,c,d):s.replaceWith(c,d,r),n.updateSelection&&function(t,e,n){const s=t.steps.length-1;if(s<e)return;const r=t.steps[s];if(!(r instanceof a.Pu||r instanceof a.FC))return;const i=t.mapping.maps[s];let c=0;i.forEach(((t,e,n,o)=>{0===c&&(c=o)})),t.setSelection(o.Y1.near(t.doc.resolve(c),n))}(s,s.steps.length-1,-1)}return!0},joinUp:()=>({state:t,dispatch:e})=>(0,c.MI)(t,e),joinDown:()=>({state:t,dispatch:e})=>(0,c.Ig)(t,e),joinBackward:()=>({state:t,dispatch:e})=>(0,c.al)(t,e),joinForward:()=>({state:t,dispatch:e})=>(0,c.Y_)(t,e),keyboardShortcut:t=>({editor:e,view:n,tr:o,dispatch:s})=>{const r=function(t){const e=t.split(/-(?!$)/);let n,o,s,r,i=e[e.length-1];"Space"===i&&(i=" ");for(let a=0;a<e.length-1;a+=1){const t=e[a];if(/^(cmd|meta|m)$/i.test(t))r=!0;else if(/^a(lt)?$/i.test(t))n=!0;else if(/^(c|ctrl|control)$/i.test(t))o=!0;else if(/^s(hift)?$/i.test(t))s=!0;else{if(!/^mod$/i.test(t))throw new Error(`Unrecognized modifier name: ${t}`);q()||J()?r=!0:o=!0}}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),r&&(i=`Meta-${i}`),s&&(i=`Shift-${i}`),i}(t).split(/-(?!$)/),i=r.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===i?" ":i,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null===c||void 0===c||c.steps.forEach((t=>{const e=t.map(o.mapping);e&&s&&o.maybeStep(e)})),!0},lift:(t,e={})=>({state:n,dispatch:o})=>!!X(n,f(t,n.schema),e)&&(0,c.xb)(n,o),liftEmptyBlock:()=>({state:t,dispatch:e})=>(0,c.X0)(t,e),liftListItem:t=>({state:e,dispatch:n})=>{const o=f(t,e.schema);return(0,d.IB)(o)(e,n)},newlineInCode:()=>({state:t,dispatch:e})=>(0,c.QK)(t,e),resetAttributes:(t,e)=>({tr:n,state:o,dispatch:s})=>{let r=null,i=null;const a=Q("string"===typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(r=f(t,o.schema)),"mark"===a&&(i=K(t,o.schema)),s&&n.selection.ranges.forEach((t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,o)=>{r&&r===t.type&&n.setNodeMarkup(o,void 0,Z(t.attrs,e)),i&&t.marks.length&&t.marks.forEach((s=>{i===s.type&&n.addMark(o,o+t.nodeSize,i.create(Z(s.attrs,e)))}))}))})),!0)},scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),selectAll:()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),selectNodeBackward:()=>({state:t,dispatch:e})=>(0,c._M)(t,e),selectNodeForward:()=>({state:t,dispatch:e})=>(0,c.o)(t,e),selectParentNode:()=>({state:t,dispatch:e})=>(0,c.N0)(t,e),selectTextblockEnd:()=>({state:t,dispatch:e})=>(0,c.nw)(t,e),selectTextblockStart:()=>({state:t,dispatch:e})=>(0,c.U9)(t,e),setContent:(t,e=!1,n={})=>({tr:o,editor:s,dispatch:r})=>{const{doc:i}=o,a=tt(t,s.schema,n);return r&&o.replaceWith(0,i.content.size,a).setMeta("preventUpdate",!e),!0},setMark:(t,e={})=>({tr:n,state:o,dispatch:s})=>{const{selection:r}=n,{empty:i,ranges:a}=r,c=K(t,o.schema);if(s)if(i){const t=st(o,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach((t=>{const s=t.$from.pos,r=t.$to.pos;o.doc.nodesBetween(s,r,((t,o)=>{const i=Math.max(o,s),a=Math.min(o+t.nodeSize,r);t.marks.find((t=>t.type===c))?t.marks.forEach((t=>{c===t.type&&n.addMark(i,a,c.create({...t.attrs,...e}))})):n.addMark(i,a,c.create(e))}))}));return function(t,e,n){var o;const{selection:s}=e;let r=null;if(W(s)&&(r=s.$cursor),r){const e=null!==(o=t.storedMarks)&&void 0!==o?o:r.marks();return!!n.isInSet(e)||!e.some((t=>t.type.excludes(n)))}const{ranges:i}=s;return i.some((({$from:e,$to:o})=>{let s=0===e.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(e.pos,o.pos,((t,e,o)=>{if(s)return!1;if(t.isInline){const e=!o||o.type.allowsMarkType(n),r=!!n.isInSet(t.marks)||!t.marks.some((t=>t.type.excludes(n)));s=e&&r}return!s})),s}))}(o,n,c)},setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),setNode:(t,e={})=>({state:n,dispatch:o,chain:s})=>{const r=f(t,n.schema);return r.isTextblock?s().command((({commands:t})=>!!(0,c.uJ)(r,e)(n)||t.clearNodes())).command((({state:t})=>(0,c.uJ)(r,e)(t,o))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,s=U(t,0,n.content.size),r=o.qv.create(n,s);e.setSelection(r)}return!0},setTextSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:s,to:r}="number"===typeof t?{from:t,to:t}:t,i=o.Bs.atStart(n).from,a=o.Bs.atEnd(n).to,c=U(s,i,a),d=U(r,i,a),l=o.Bs.create(n,c,d);e.setSelection(l)}return!0},sinkListItem:t=>({state:e,dispatch:n})=>{const o=f(t,e.schema);return(0,d.bw)(o)(e,n)},splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:s,editor:r})=>{const{selection:i,doc:c}=e,{$from:d,$to:l}=i,u=at(r.extensionManager.attributes,d.node().type.name,d.node().attrs);if(i instanceof o.qv&&i.node.isBlock)return!(!d.parentOffset||!(0,a.Ax)(c,d.pos))&&(s&&(t&&lt(n,r.extensionManager.splittableMarks),e.split(d.pos).scrollIntoView()),!0);if(!d.parent.isBlock)return!1;if(s){const s=l.parentOffset===l.parent.content.size;i instanceof o.Bs&&e.deleteSelection();const c=0===d.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(d.node(-1).contentMatchAt(d.indexAfter(-1)));let p=s&&c?[{type:c,attrs:u}]:void 0,m=(0,a.Ax)(e.doc,e.mapping.map(d.pos),1,p);if(p||m||!(0,a.Ax)(e.doc,e.mapping.map(d.pos),1,c?[{type:c}]:void 0)||(m=!0,p=c?[{type:c,attrs:u}]:void 0),m&&(e.split(e.mapping.map(d.pos),1,p),c&&!s&&!d.parentOffset&&d.parent.type!==c)){const t=e.mapping.map(d.before()),n=e.doc.resolve(t);d.node(-1).canReplaceWith(n.index(),n.index()+1,c)&&e.setNodeMarkup(e.mapping.map(d.before()),c)}t&&lt(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return!0},splitListItem:t=>({tr:e,state:n,dispatch:s,editor:r})=>{var c;const d=f(t,n.schema),{$from:l,$to:u}=n.selection,p=n.selection.node;if(p&&p.isBlock||l.depth<2||!l.sameParent(u))return!1;const m=l.node(-1);if(m.type!==d)return!1;const h=r.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==d||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let t=i.HY.empty;const n=l.index(-1)?1:l.index(-2)?2:3;for(let e=l.depth-n;e>=l.depth-3;e-=1)t=i.HY.from(l.node(e).copy(t));const s=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,r=at(h,l.node().type.name,l.node().attrs),a=(null===(c=d.contentMatch.defaultType)||void 0===c?void 0:c.createAndFill(r))||void 0;t=t.append(i.HY.from(d.createAndFill(null,a)||void 0));const u=l.before(l.depth-(n-1));e.replace(u,l.after(-s),new i.p2(t,4-n,0));let p=-1;e.doc.nodesBetween(u,e.doc.content.size,((t,e)=>{if(p>-1)return!1;t.isTextblock&&0===t.content.size&&(p=e+1)})),p>-1&&e.setSelection(o.Bs.near(e.doc.resolve(p))),e.scrollIntoView()}return!0}const g=u.pos===l.end()?m.contentMatchAt(0).defaultType:null,y=at(h,m.type.name,m.attrs),v=at(h,l.node().type.name,l.node().attrs);e.delete(l.pos,u.pos);const b=g?[{type:d,attrs:y},{type:g,attrs:v}]:[{type:d,attrs:y}];if(!(0,a.Ax)(e.doc,l.pos,2))return!1;if(s){const{selection:t,storedMarks:o}=n,{splittableMarks:i}=r.extensionManager,a=o||t.$to.parentOffset&&t.$from.marks();if(e.split(l.pos,2,b).scrollIntoView(),!a||!s)return!0;const c=a.filter((t=>i.includes(t.type.name)));e.ensureMarks(c)}return!0},toggleList:(t,e,n,o={})=>({editor:s,tr:r,state:i,dispatch:a,chain:c,commands:d,can:l})=>{const{extensions:u,splittableMarks:p}=s.extensionManager,m=f(t,i.schema),h=f(e,i.schema),{selection:g,storedMarks:y}=i,{$from:v,$to:b}=g,k=v.blockRange(b),x=y||g.$to.parentOffset&&g.$from.marks();if(!k)return!1;const M=et((t=>dt(t.type.name,u)))(g);if(k.depth>=1&&M&&k.depth-M.depth<=1){if(M.node.type===m)return d.liftListItem(h);if(dt(M.node.type.name,u)&&m.validContent(M.node.content)&&a)return c().command((()=>(r.setNodeMarkup(M.pos,m),!0))).command((()=>ut(r,m))).command((()=>pt(r,m))).run()}return n&&x&&a?c().command((()=>{const t=l().wrapInList(m,o),e=x.filter((t=>p.includes(t.type.name)));return r.ensureMarks(e),!!t||d.clearNodes()})).wrapInList(m,o).command((()=>ut(r,m))).command((()=>pt(r,m))).run():c().command((()=>!!l().wrapInList(m,o)||d.clearNodes())).wrapInList(m,o).command((()=>ut(r,m))).command((()=>pt(r,m))).run()},toggleMark:(t,e={},n={})=>({state:o,commands:s})=>{const{extendEmptyMarkRange:r=!1}=n,i=K(t,o.schema);return ct(o,i,e)?s.unsetMark(i,{extendEmptyMarkRange:r}):s.setMark(i,e)},toggleNode:(t,e,n={})=>({state:o,commands:s})=>{const r=f(t,o.schema),i=f(e,o.schema);return X(o,r,n)?s.setNode(i):s.setNode(r,n)},toggleWrap:(t,e={})=>({state:n,commands:o})=>{const s=f(t,n.schema);return X(n,s,e)?o.lift(s):o.wrapIn(s,e)},undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let o=0;o<n.length;o+=1){const s=n[o];let r;if(s.spec.isInputRules&&(r=s.getState(t))){if(e){const e=t.tr,n=r.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(r.text){const n=e.doc.resolve(r.from).marks();e.replaceWith(r.from,r.to,t.schema.text(r.text,n))}else e.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:o,ranges:s}=n;return o||e&&s.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0},unsetMark:(t,e={})=>({tr:n,state:o,dispatch:s})=>{var r;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=K(t,o.schema),{$from:d,empty:l,ranges:u}=a;if(!s)return!0;if(l&&i){let{from:t,to:e}=a;const o=null===(r=d.marks().find((t=>t.type===c)))||void 0===r?void 0:r.attrs,s=V(d,c,o);s&&(t=s.from,e=s.to),n.removeMark(t,e,c)}else u.forEach((t=>{n.removeMark(t.$from.pos,t.$to.pos,c)}));return n.removeStoredMark(c),!0},updateAttributes:(t,e={})=>({tr:n,state:o,dispatch:s})=>{let r=null,i=null;const a=Q("string"===typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(r=f(t,o.schema)),"mark"===a&&(i=K(t,o.schema)),s&&n.selection.ranges.forEach((t=>{const s=t.$from.pos,a=t.$to.pos;o.doc.nodesBetween(s,a,((t,o)=>{r&&r===t.type&&n.setNodeMarkup(o,void 0,{...t.attrs,...e}),i&&t.marks.length&&t.marks.forEach((r=>{if(i===r.type){const c=Math.max(o,s),d=Math.min(o+t.nodeSize,a);n.addMark(c,d,i.create({...r.attrs,...e}))}}))}))})),!0)},wrapIn:(t,e={})=>({state:n,dispatch:o})=>{const s=f(t,n.schema);return(0,c.ym)(s,e)(n,o)},wrapInList:(t,e={})=>({state:n,dispatch:o})=>{const s=f(t,n.schema);return(0,d.KI)(s,e)(n,o)}});const ht=D.create({name:"commands",addCommands:()=>({...mt})}),ft=D.create({name:"editable",addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),gt=D.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new o.Sy({key:new o.H$("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const o=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1},blur:(e,n)=>{t.isFocused=!1;const o=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1}}}})]}}),yt=D.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.command((({tr:e})=>{const{selection:n,doc:s}=e,{empty:r,$anchor:i}=n,{pos:a,parent:c}=i,d=o.Y1.atStart(s).from===a;return!(!(r&&d&&c.type.isTextblock)||c.textContent.length)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),e=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()])),n={Enter:()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...n},r={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return q()||J()?r:s},addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some((t=>t.docChanged))&&!e.doc.eq(n.doc)))return;const{empty:s,from:r,to:i}=e.selection,a=o.Y1.atStart(e.doc).from,c=o.Y1.atEnd(e.doc).to;if(s||!(r===a&&i===c))return;if(!(0===n.doc.textBetween(0,n.doc.content.size," "," ").length))return;const d=n.tr,p=l({state:n,transaction:d}),{commands:m}=new u({editor:this.editor,state:p});return m.clearNodes(),d.steps.length?d:void 0}})]}}),vt=D.create({name:"tabindex",addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var bt=Object.freeze({__proto__:null,ClipboardTextSerializer:z,Commands:ht,Editable:ft,FocusEvents:gt,Keymap:yt,Tabindex:vt});class kt extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t,e){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const o=document.createElement("style");return e&&o.setAttribute("nonce",e),o.setAttribute("data-tiptap-style",""),o.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(o),o}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=v(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],o=this.state.reconfigure({plugins:n});this.view.updateState(o)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"===typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(bt):[],...this.options.extensions].filter((t=>["extension","node","mark"].includes(null===t||void 0===t?void 0:t.type)));this.extensionManager=new P(t,this)}createCommandManager(){this.commandManager=new u({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=tt(this.options.content,this.schema,this.options.parseOptions),e=_(t,this.options.autofocus);this.view=new s.tk(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:o.yy.create({doc:t,selection:e||void 0})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=t.getMeta("focus"),s=t.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:t}),s&&this.emit("blur",{editor:this,event:s.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return rt(this.state,t)}isActive(t,e){const n="string"===typeof t?t:null,o="string"===typeof t?e:t;return function(t,e,n={}){if(!e)return X(t,null,n)||ct(t,null,n);const o=Q(e,t.schema);return"node"===o?X(t,e,n):"mark"===o&&ct(t,e,n)}(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return nt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return ot(this.state.doc,{blockSeparator:e,textSerializers:{...R(this.schema),...n}})}get isEmpty(){return function(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),o=t.toJSON();return JSON.stringify(n)===JSON.stringify(o)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function xt(t){return new O({find:t.find,handler:({state:e,range:n,match:o})=>{const s=b(t.getAttributes,void 0,o);if(!1===s||null===s)return null;const{tr:r}=e,i=o[o.length-1],a=o[0];let c=n.to;if(i){const o=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(it(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>d)).length)return null;l<n.to&&r.delete(l,n.to),d>n.from&&r.delete(n.from+o,d),c=n.from+o+i.length,r.addMark(n.from+o,c,t.type.create(s||{})),r.removeStoredMark(t.type)}}})}function Mt(t){return new O({find:t.find,handler:({state:e,range:n,match:o})=>{const s=b(t.getAttributes,void 0,o)||{},{tr:r}=e,i=n.from;let a=n.to;if(o[1]){let e=i+o[0].lastIndexOf(o[1]);e>a?e=a:a=e+o[1].length;const n=o[0][o[0].length-1];r.insertText(n,i+o[0].length-1),r.replaceWith(e,a,t.type.create(s))}else o[0]&&r.replaceWith(i,a,t.type.create(s))}})}function wt(t){return new O({find:t.find,handler:({state:e,range:n,match:o})=>{const s=e.doc.resolve(n.from),r=b(t.getAttributes,void 0,o)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,r)}})}class St{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=b(p(this,"addOptions",{name:this.name}))),this.storage=b(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new St(t)}configure(t={}){const e=this.extend();return e.options=j(this.options,t),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new St(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=b(p(e,"addOptions",{name:e.name})),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){const s=o.marks();if(!!!s.find((t=>(null===t||void 0===t?void 0:t.type.name)===e.name)))return!1;const r=s.find((t=>(null===t||void 0===t?void 0:t.type.name)===e.name));return r&&n.removeStoredMark(r),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}}class Et{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=b(p(this,"addOptions",{name:this.name}))),this.storage=b(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Et(t)}configure(t={}){const e=this.extend();return e.options=j(this.options,t),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Et(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=b(p(e,"addOptions",{name:e.name})),e.storage=b(p(e,"addStorage",{name:e.name,options:e.options})),e}}class Ot{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,n,s,r,i,a,c;const{view:d}=this.editor,l=t.target,u=3===l.nodeType?null===(e=l.parentElement)||void 0===e?void 0:e.closest("[data-drag-handle]"):l.closest("[data-drag-handle]");if(!this.dom||(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(l))||!u)return;let p=0,m=0;if(this.dom!==u){const e=this.dom.getBoundingClientRect(),n=u.getBoundingClientRect(),o=null!==(s=t.offsetX)&&void 0!==s?s:null===(r=t.nativeEvent)||void 0===r?void 0:r.offsetX,c=null!==(i=t.offsetY)&&void 0!==i?i:null===(a=t.nativeEvent)||void 0===a?void 0:a.offsetY;p=n.x-e.x+o,m=n.y-e.y+c}null===(c=t.dataTransfer)||void 0===c||c.setDragImage(this.dom,p,m);const h=o.qv.create(d.state.doc,this.getPos()),f=d.state.tr.setSelection(h);d.dispatch(f)}stopEvent(t){var e;if(!this.dom)return!1;if("function"===typeof this.options.stopEvent)return this.options.stopEvent({event:t});const n=t.target;if(!(this.dom.contains(n)&&!(null===(e=this.contentDOM)||void 0===e?void 0:e.contains(n))))return!1;const s=t.type.startsWith("drag"),r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!r&&!s)return!0;const{isEditable:i}=this.editor,{isDragging:a}=this,c=!!this.node.type.spec.draggable,d=o.qv.isSelectable(this.node),l="copy"===t.type,u="paste"===t.type,p="cut"===t.type,m="mousedown"===t.type;if(!c&&d&&s&&t.preventDefault(),c&&s&&!a)return t.preventDefault(),!1;if(c&&i&&!a&&m){const t=n.closest("[data-drag-handle]");t&&(this.dom===t||this.dom.contains(t))&&(this.isDragging=!0,document.addEventListener("dragend",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("drop",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("mouseup",(()=>{this.isDragging=!1}),{once:!0}))}return!(a||r||l||u||p||m&&d)}ignoreMutation(t){if(!this.dom||!this.contentDOM)return!0;if("function"===typeof this.options.ignoreMutation)return this.options.ignoreMutation({mutation:t});if(this.node.isLeaf||this.node.isAtom)return!0;if("selection"===t.type)return!1;if(this.dom.contains(t.target)&&"childList"===t.type&&q()&&this.editor.isFocused){if([...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every((t=>t.isContentEditable)))return!1}return this.contentDOM===t.target&&"attributes"===t.type||!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command((({tr:e})=>{const n=this.getPos();return e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0}))}deleteNode(){const t=this.getPos(),e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}}function Tt(t){return new A({find:t.find,handler:({state:e,range:n,match:o})=>{const s=b(t.getAttributes,void 0,o);if(!1===s||null===s)return null;const{tr:r}=e,i=o[o.length-1],a=o[0];let c=n.to;if(i){const o=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(it(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>d)).length)return null;l<n.to&&r.delete(l,n.to),d>n.from&&r.delete(n.from+o,d),c=n.from+o+i.length,r.addMark(n.from+o,c,t.type.create(s||{})),r.removeStoredMark(t.type)}}})}function Ct(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}}}]);